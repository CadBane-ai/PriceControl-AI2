# Test Design: Story 2.7

Date: 2025-09-17
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 10
- Unit tests: 2 (20%)
- Integration tests: 6 (60%)
- E2E tests: 2 (20%)
- Priority distribution: P0: 7, P1: 3, P2: 0

## Test Scenarios by Acceptance Criteria

### AC1, AC2, AC5, AC6: Conversation API Routes

| ID | Level | Priority | Test | Justification |
|---|---|---|---|---|
| 2.7-INT-001 | Integration | P0 | Verify that unauthenticated requests to the conversation API routes return a 401 error. | Security. |
| 2.7-INT-002 | Integration | P0 | Verify that `POST /api/conversations` creates a new conversation in the database. | Core functionality. |
| 2.7-INT-003 | Integration | P0 | Verify that `GET /api/conversations` returns a list of the user's conversations, sorted by `updatedAt`. | Core functionality. |
| 2.7-INT-004 | Integration | P0 | Verify that `PATCH /api/conversations/{id}` renames a conversation. | Core functionality. |
| 2.7-INT-005 | Integration | P1 | Verify that the API returns a 404 error for an unknown conversation ID. | Error handling. |
| 2.7-INT-006 | Integration | P1 | Verify that the API returns a 400 error for an invalid rename payload. | Input validation. |

### AC3, AC4: Sidebar UI

| ID | Level | Priority | Test | Justification |
|---|---|---|---|---|
| 2.7-UNIT-001 | Unit | P1 | Verify that the recency badges are displayed correctly. | UI correctness. |
| 2.7-E2E-001 | E2E | P0 | Manually verify that clicking the "New conversation" button creates a new conversation, navigates to it, and shows a toast. | User experience. |
| 2.7-E2E-002 | E2E | P0 | Manually verify that the active conversation is highlighted in the sidebar. | User experience. |

### AC7: General Testing

| ID | Level | Priority | Test | Justification |
|---|---|---|---|---|
| 2.7-UNIT-002 | Unit | P0 | Verify that the UI handles API errors gracefully and shows appropriate toast messages. | Robustness. |

## Recommended Execution Order

1. P0 Unit tests
2. P0 Integration tests
3. P0 E2E tests
4. P1 tests in order
